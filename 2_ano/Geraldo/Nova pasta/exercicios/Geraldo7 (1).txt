
Disciplina: Banco de Dados II (Exercício 07)  
Uni-FACEF – Centro Universitário de Franca | Franca 
Nome: Pedro Henrique Silva Marçal
Código: 22646

1 - 
SELECT nome e, ds_funcao f FROM tb_empregado e, tb_funcao f WHERE e.data_admissao BETWEEN '02-feb-1987' AND '01-may-1989';

2 -
SELECT UPPER(e.nome) as "Nome", LENGTH(e.sobrenome) as "Tamanho_Sobrenome", p.nm_pais as "Pais", d.nm_departamento as "Departamento"
FROM tb_empregado e 
INNER JOIN tb_departamento d ON e.id_departamento = d.id_departamento
INNER JOIN tb_localizacao l ON l.id_localizacao = d.id_localizacao
INNER JOIN tb_pais p ON l.id_pais = p.id_pais
WHERE e.nome LIKE 'L%' OR e.nome LIKE 'B%' OR e.nome LIKE 'A%' 
;

3-
SELECT e.nome as "Nome", d.nm_departamento as "Departamento", l.estado as "Estado", l.cidade  as "Cidade"
FROM tb_empregado e 
INNER JOIN tb_departamento d ON e.id_departamento = d.id_departamento
INNER JOIN tb_localizacao l ON l.id_localizacao = d.id_localizacao
WHERE e.percentual_comissao = 0.0 OR e.percentual_comissao IS NULL
;

4-
SELECT e.nome || ' Trabalha para o(a) ' || NVL(g.nome, 'os acionistas') 
FROM tb_empregado e 
LEFT JOIN tb_empregado g ON e.id_empregado = g.id_gerente;

5- 
create or replace
PROCEDURE "SP_GET_EMP"(p_id IN INTEGER) AS
v_nome    tb_empregado.nome%TYPE;
v_sobrenome     tb_empregado.sobrenome%TYPE;
v_funcao      tb_funcao.ds_funcao%TYPE;
v_controle INTEGER;

BEGIN
  SELECT COUNT(1) INTO v_controle 
  FROM tb_empregado
  WHERE id_empregado = p_id;
  
  IF (v_controle = 1) THEN 
  SELECT e.nome, e.sobrenome, f.ds_funcao INTO v_nome, v_sobrenome,  v_funcao, v_controle
  FROM tb_empregado e 
  INNER JOIN tb_funcao f ON e.id_funcao = f.id_funcao;
  
  dbms_output.put_line('Nome: ' || v_nome || ' Sobrenome: ' || v_sobrenome || ' Funcao: ' || v_funcao);
  ELSE 
  dbms_output.put_line('Empregado nao encontrado');
  
  END IF;
  
  exception
    WHEN OTHER THEN 
			DBMS_OUTPUT.PUT_LINE(' Erro !!!');
END
